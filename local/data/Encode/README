the samplesheet contains paths to the HDF5 files in the genome_db repository

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~WHAT IS ENCODE (in short!)~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
atac-seq: assay for transposase-accessible chromatin using sequencing
          direct in vitro transposition of sequencing adaptors into native chromatin
          human CD4+ T cells 
          GM12878 human lymphoblastoid cell line (Encyclopedia of DNA Elements (ENCODE) Tier 1          

MNase-seq: micrococcal nuclease digestion followed by sequencing 

ChIP-seq: chromatin immunoprecipitation followed by sequencing 


ENCODE Tier1
   GM12878 (a lymphoblastoid cell line produced from the blood of a female donor with northern and western European ancestry by EBV transformation. It was one of the original HapMap cell lines and has been selected by the International HapMap Project for deep sequencing using the Solexa/Illumina platform. This cell line has a relatively normal karyotype and grows well. Choice of this cell line offers potential synergy with the International HapMap Project and genetic variation studies. It represents the mesoderm cell lineage. Cells will be obtained from the Coriell Institute for Medical Research [coriell.org] (Catalog ID GM12878). )

   K562 (an immortalized cell line produced from a female patient with chronic myelogenous leukemia (CML). It is a widely used model for cell biology, biochemistry, and erythropoiesis. It grows well, is transfectable, and represents the mesoderm linage. Cells will be obtained from the America Type Culture Collection (ATCC) [atcc.org] (ATCC Number CCL-243).  )

   H1 human embryonic stem cells will be obtained from Cellular Dynamics International 

ENCODE Tier2
   HeLa-S3 is an immortalized cell line that was derived from a cervical cancer patient. It grows extremely well in suspension and is transfectable. It represents the ectoderm lineage. Many data sets were produced using this cell line during the pilot phase of the ENCODE Project. In addition, these cells have been widely used in biochemical and molecular genetic studies of gene function and regulation. Cells will be obtained from the America Type Culture Collection (ATCC) [atcc.org] (ATCC Number CCL-2.2).

   HepG2 is a cell line derived from a male patient with liver carcinoma. It is a model system for metabolism disorders and much data on transcriptional regulation have been generated using this cell line. It grows well, is transfectable, and represents the endoderm lineage. Cells will be obtained from the America Type Culture Collection (ATCC) [atcc.org] (ATCC Number HB-8065).

   HUVEC (human umbilical vein endothelial cells) have a normal karyotype and are readily expandable to 108-109 cells. They represent the mesoderm lineage. Cells will be obtained from Lonza Biosciences [lonza.com]. 


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~NOTES ON genome_db (the repo where we extracted the ENCODE data from)~~~~~~~~~~~~~~~~~~~~~
/data/share/10_IND quality.sort.nodup2.bam
/data/share/genome_db/hg18/10_IND fwd file: shifted forward strand counts 
data filtering: remove duplicates (PCR or optical duplicates, reads are shifted, multiple lanes are combined into a single binary file, reads are filtered for ones where the SNP can cause a reference bias in mapping
NOTES on files in encode_chipseq/Gm12878* and encode_chipseq/H1hesc*:
/data/share/genome_db/hg19/encode_chipseq/H1hesc_Yy1_rev.h5 #are merged replicates
/data/share/genome_db/hg19/encode_chipseq/H1hesc_Yy1_fwd.h5 #"



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
WRITE HDF5 FILES FROM BAM FILES AND GET TRACK STATS (MAKE SURE YOU HAVE ENOUGH MEMORY TO RUN THIS COMMANDS)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
python ~/src/genome/python/script/db/load_bam_5prime_ends.py --assembly hg19 /my_tracks/fwd_read_counts \
    /my_tracks/rev_read_counts \
    wgEncodeDataRep1.bam   wgEncodeDataRep2.bam

#merge reverse and forward strands (use relative path):
python ~/src/genome/python/script/db/combine_chipseq_strands.py --assembly hg19 encode_chipseq/Gm12878_Yy1_Rep1_fwd.h5 encode_chipseq/Gm12878_Yy1_Rep1_rev.h5 encode_chipseq/Gm12878_Yy1_Rep1.h5 #shift=55 cov=0.756198
python ~/src/genome/python/script/db/combine_chipseq_strands.py --assembly hg19 encode_chipseq/Gm12878_Yy1_Rep2_fwd.h5 encode_chipseq/Gm12878_Yy1_Rep2_rev.h5 encode_chipseq/Gm12878_Yy1_Rep2.h5 #shift=55 cov=0.406694
python ~/src/genome/python/script/db/combine_chipseq_strands.py --assembly hg19 encode_chipseq/H1hesc_Yy1_Rep1_fwd.h5 encode_chipseq/H1hesc_Yy1_Rep1_rev.h5 encode_chipseq/H1hesc_Yy1_Rep1.h5 #shift=54 cov=2.82626 
python ~/src/genome/python/script/db/combine_chipseq_strands.py --assembly hg19 encode_chipseq/H1hesc_Yy1_Rep2_fwd.h5 encode_chipseq/H1hesc_Yy1_Rep2_rev.h5 encode_chipseq/H1hesc_Yy1_Rep2.h5 #shift=71 cov=0.596022                   
#set track stats
python ~/src/genome/python/script/db/set_track_stats.py --assembly hg19 encode_chipseq/H1hesc_Yy1_Rep1.h

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
WRITE LIST OF LOCI WHERE YOU WANT TO RUN MULTISEQ 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sh write_list_loci.sh 8192 > list_loci
#write_list_loci.sh creates a bed file (list_loci) with adjacent intervals of size 8192. it uses a file with chromosome lengths

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
RUN MULTISEQ: ONE JOB FOR EACH LOCUS IN BATCH MODE (code in run_multiseq.R and qsub_run_multiseq.sh)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#From spudhead run:
sh qsub_run_multiseq.sh < list_loci
#this code will, for each line in list_loci (i.e. each locus), run run_multiseq.R .
#CAREFUL: this command will run as many jobs as there are lines in list_loci!

#The ouput of run_multiseq.R is saved into /stat45800/analysis/results_run_multiseq/
#If you look into /mnt/lustre/home/epantaleo/src/stat45800/analysis/results_run_multiseq
#you will see how results are saved: there will be a directory for each locus (eg chr1.876545.884737) containing
#effect_mean_var.txt.gz (column 1: effect, column2: variance)
#summary.txt where I save {chr} {locus_start} {locus_end} {how many bases have an effect in 2se} {how many bases have an effect in 3se} {how long it takes to run the code}

